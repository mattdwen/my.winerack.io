@model IEnumerable<winerack.Models.Bottle>

@{
    ViewBag.Title = "Open a Bottle";
}

<section ng-app="tastingsApp">
    <div ng-controller="StartCtrl">
        <div class="page-header">
            <h1>Select a wine from your collection</h1>
        </div>

        <div class="jumbotron" ng-show="bottles.count < 1">
            You have no bottles to open!
        </div>

        <div class="form-inline well well-sm">
            <div class="form-group">
                <label class="sr-only" for="tastingStyle">Style</label>
                <select id="tastingStyle" ui-select2="{ allowClear: true}" data-placeholder="Style" ng-model="filter.style">
                    <option value=""></option>
                    <option ng-repeat="bottle in bottles | unique:'VarietalStyle' | orderBy:'VarietalStyle'" value=" {{ bottle.VarietalStyle }}">
                        {{ bottle.VarietalStyle}}
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label class="sr-only" for="tastingVarietal">Varietal</label>
                <select id="tastingVarietal" ui-select2="{ allowClear: true }" data-placeholder="Varietal" ng-model="filter.varietal">
                    <option value=""></option>
                    <option ng-repeat="bottle in bottles | unique:'Varietal' | orderBy:'Varietal'" value="{{ bottle.Varietal }}">
                        {{ bottle.Varietal }}
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label class="sr-only" for="tastingKeywords">Keywords</label>
                <input class="form-control" type="text" placeholder="Search"
                       ng-model="filter.keywords" />
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6 col-md-4" ng-repeat="bottle in bottles | filter:search">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="pull-right">
                            <span class="label label-primary" title="Purchased">{{ bottle.Purchased }}</span>
                            <span class="label label-danger" title="Opened">{{ bottle.Opened }}</span>
                            <span class="label label-success" title="Remaining">{{ bottle.Remaining }}</span>
                        </div>
                        <strong>{{ bottle.Description }}</strong>
                    </div>
                    <div class="panel-body">
                        <div><i class="fa fa-map-marker"></i> {{ bottle.Vineyard }}</div>
                        <div><i class="fa fa-globe"></i> {{ bottle.Region }}</div>
                        <div><i class="fa fa-clock-o"></i> {{ bottle.CellarMin }} to {{ bottle.CellarMax }} years</div>
                    </div>
                    <div class="panel-footer">
                        <a class="btn btn-primary" href="/Tastings/CreateFromBottle/?BottleId={{ bottle.ID }}">Open</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    @Scripts.Render("~/Scripts/vendor/select2.js")
    @Scripts.Render("~/bundles/angular")
    @Scripts.Render("~/Scripts/vendor/angular-ui/select2.js")
    @Scripts.Render("~/Scripts/angular/services/bottleService.js")
    @Scripts.Render("~/Scripts/angular/controllers/tastings.js")
}